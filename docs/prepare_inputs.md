# Preparing the Input Data

## Sample Sheet (CSV/TSV)

A samplesheet is required to describe the input samples, their phenotype, the location of BAM files and outputs from the fusion calling.

| RNA_ID | RNA_BAM_FILE | DROP_GROUP | PHENOTYPE | FUSIONS              |
|--------|--------------|------------|-----------|----------------------|
| S01    | /path/to/bam | MUSCLE     | Myopathy  | /path/to/fusions.tsv |
| S02    | /path/to/bam | MUSCLE     | Dystrophy | /path/to/fusions.tsv |

An [example samplesheet]() can be found in the GitHub repository.

## OUTRIDER Dataset

The OUTRIDER Dataset (`ods.Rds`) is an R object that stores the entire OUTRIDER dataset and results.
If you are running DROP, it can be found by navigating to the processed results directory for the `AberrantExpression` module:
For example, `./processed_results/aberrant_expression/{ANNOTATION}/outrider/{DROP_GROUP}/ods.Rds`

The `ods.Rds` can be loaded directly into the RNAwebapp by selecting "Browse" and navigating to the object.

## FRASER Dataset

The FRASER Dataset (`fds-object.Rds`) is an R object that stores the entire FRASER dataset and results.
If you are running DROP, it can be found by navigating to the processed data directory for the `AberrantSplicing` module:
For example, `path_to_drop_working_dir/processed_data/aberrant_splicing/datasets/savedObjects/{DROP_GROUP}--{ANNOTATION}/fds-object.Rds`

The `fds-object.Rds` relies on `.h5` data objects generated by FRASER, which are located alongside the `fds-object.Rds`in the processed data directory for the `AberrantSplicing` module:
For example, `path_to_drop_working_dir/processed_data/aberrant_splicing/datasets/savedObjects/{DROP_GROUP}--{ANNOTATION}/jaccard.h5`

To load the FRASER dataset into RNAwebapp, you must specify the FRASER working directory and the FRASER analysis name, then select "Load FRASER Dataset".
If you are running DROP, the FRASER working directory will be `path_to_drop_working_dir/processed_data/aberrant_splicing/datasets/`.
The FRASER analysis name is by default `{DROP_GROUP}--{ANNOTATION}`, where `DROP_GROUP`, i.e. "`MUSCLE`", and the "`ANNOTATION`"", i.e. "`113`" is the gene annotation version.
These are specified in the original sample annotation provided as input into DROP.

> ⚠ Use caution when transferring these objects from a remote server to a local server to use as input into the RNAwebapp and use the following rules:
> ⚠️ Sample IDs must match across all files.

- The FRASER dataset (`fds-object.Rds`) should be in a sub-directory of your working data directory called `savedObjects/{DROUP_GROUP--{ANNOTATION}`
- The should be accompanied by `.h5` objects in this same sub-directory.

So if you are storing your data in `~/RNAwebapp/data/`, and your analysis name is `MUSCLE--v113` then the `fds-object.Rds` and `.h5` data objects should be stored `~/RNAwebapp/data/savedObjects/MUSCLE--v113`

## BAM Directory

Enter the absolute path to where the BAM files are stored. 
For example: `~/RNAwebapp/data/bams`

## RNA Variants

## Important Considerations

> ⚠️ Sample IDs must match across all files.

It is important that the sample IDs in the sample annotation match those in the OUTRIDER and FRASER datasets and the RNA VCFs.
This can be confirmed by inspecting the column names of the ods.Rds and fds-object.Rds files:
```
colnames(ods)
colnames(fds)
```
It is okay to have samples present in one dataset but not the other. 

---
